## h2 Scanning Cyberspace

Seuraa työkalujen toimintaa toisella työkalulla. Esim. seuraa porttiskanneria snifferillä. Irrota tarvittaessa tietokoneet Internetistä kokeilujen ajaksi.

### x) Lue/katso ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva kustakin artikkelista. Kannattaa lisätä myös jokin oma ajatus, idea, huomio tai kysymys.)
#### - Lyon 2009: Nmap Network Scanning: Chapter 15. Nmap Reference Guide:
  - Port Scanning Basics (opettele, mitä tarkoittavat: open, closed, filtered; muuten vain silmäily)
  - Port Scanning Techniques (opettele, mitä ovat: -sS -sT -sU; muuten vain silmäily)
#### - KKO 2003:36. Alaikäinen tuomittiin Osuuspankkikeskuksen porttiskannaamisesta, korkeimman oikeuden ratkaisu.
#### - Vapaavalintainen läpikävely 0xdf tai ippsec (Kannattaa valita helppo; esim "Base Points: Easy")

-------------

### a) Asenna Kali virtuaalikoneeseen
HUOM! VirtualBox 7.0 asennettiin jo aiempia tehtäviä varten, jote tässä harjoituksessa se on valmiiksi asennettuna.
 
Kalin asentamisen aloitin lataamalla Kalin `.iso` tiedoston osoitteesta: `https://www.kali.org/get-kali/#kali-installer-images`

Loin VirtualBoxiin uuden koneen nimeltä Penkali, johon määritin 8gb rammia ja 50gb virtuaalikovalevy tilaa. Lopulta käynnistin virtuaalikoneen ja aloitin kalin asentamisen.<br>

![image](https://github.com/AArmias/pentest/assets/102689055/7f6f0b53-86b0-4f18-9424-f08b353771b3)

Kieleksi englanti, sijainniksi finland, näppäimmistöksi finnish ja asennus alkaa. 

![image](https://github.com/AArmias/pentest/assets/102689055/744f9599-1621-4bc7-85c1-539178941570)


Root käyttäjän luonti (penkali) ja käyttäjän luonti (terokali), muuten otin käyttöön suositellut asetukset ja lyhyen next next next ja continue, continue, continue painamisen jälkeen saatiin asennus käyntiin.
<br>
Lopulta asennus on valmis ja voidaan kokeilla toimiiko Kali. <br>
Kirjautuminen terokali tunnuksella ainakin onnistui. 
![image](https://github.com/AArmias/pentest/assets/102689055/626c8442-8fe4-42ee-a17c-667b8e79a30b) 
<br>

Myös firefox ja internet yhteys toimii, esimerkkinä wikipedian etusivu: 
![image](https://github.com/AArmias/pentest/assets/102689055/89312133-9c76-4f9f-8c57-155ff3883494)


--------------------------------

### b) Asenna Metasploitable 2 virtuaalikoneeseen
Aloitin asentamisen lataamalla tarvittavat tiedostot osoitteesta: `https://sourceforge.net/projects/metasploitable/`
Katosin lisäksi ohjeita asennukseen youtube videosta: "install Kali Linux 2024.1 & Metasploitable2 on VirtualBox 7 Step By Step : Cyber Security Lab 2024" - `https://www.youtube.com/watch?v=yf3jetn4tN8`
ja tueksi avasin lisäksi Metaspoiltablen ohjeet: `https://docs.rapid7.com/metasploit/metasploitable-2`
Ladattuani `metaspoitable-linux-2.0.0.zipi`n ja purettuani sen, käynnistin virtuaalikoneen ja aloitin uuden virtuaalikoneen luomisen. 
Asennuksen nimi, kansio jonne asennetaan, asennustyyppi Linux ja Ubuntu (32-bit).

![image](https://github.com/AArmias/pentest/assets/102689055/4ab65028-28e7-4630-8342-1ecbea860f6f)

2gb rammia (Katsomassani asennus guidessa todettiin, että yksi 1,5gb riittäisi jo hyvin tähän tarkoitukseen.) 2 cputa. 

![image](https://github.com/AArmias/pentest/assets/102689055/a3ab0786-b0c5-4865-ba2f-a18d6961d691)

Valitaan virtuaaliseksi kovalevyksi jo valmiina olevan virtuaalikovalevyn käyttö ja etsitään aiemmin ladattu ja purettu `Metaspoitable.vmdk` tiedosto. 

![image](https://github.com/AArmias/pentest/assets/102689055/7ac16c6d-8d4e-459e-be64-a8d97a9f1f81)

ja valitaan Finish. 

Nyt virtuaalikone on luotu. Käynnistetään se ja annetaan hetkisen aikaa asennella itseään. 
![image](https://github.com/AArmias/pentest/assets/102689055/0cb52a12-4ab9-4f53-953d-ca0a9d75a709)
Nyt meillä on käynnissä Metasloitable 2. Koitetaan kirjautua sisälle. Tunnus:`msfadmin` ja Salasana:`msfadmin`
![image](https://github.com/AArmias/pentest/assets/102689055/f03331d8-7e20-4015-befd-4c9b5c858387)
Onnistu! <br>

Ohjeiden mukaan lisäksi pitää identikoida ip osoite komennolla `ifconfig`: 
![image](https://github.com/AArmias/pentest/assets/102689055/47e64c3a-1108-4b8a-8297-0206fbbf86b6)
ja ottaa inet osoite talteen. Tätä inet osoitetta jatkossa käytetään ohjeiden mukaan testaamiseen. 
<br>
Asennus on siis onnistunut ja toimiva. 

-------------------------------------

### c) Tee koneille virtuaaliverkko, jossa Kalin ja Metasploitablen välillä on host-only network, niin että porttiskannatessa ym. koneet on eristetty intenetistä, mutta ne saavat yhteyden toisiinsa. 
Koska sekä Kali versio linuxista, sekä Metasploitable 2 olivat ihan uusia tuttavuuksia itselleni, samoin kuin virtuaali verkon rakentaminen etsin apua googlesta ja löysin aiemman kurssin raportin, jossa virtuaaliverkon luonti käytiin hyvin läpi. 
Tässä löytämäni ohje: `https://susannalehto.fi/2023/oma-labra-tunkeutumistestaukseen-h1/`
Lähdin siis Susannan ohjeen mukaisesti lähestymään virtuaaliverkon luontia Virtualboxin graaffisen käyttöliittymän kautta luomalla uuden virtuaaliverkon vain tätä testiympäristöä varten. 
VirtualBoxin käyttöliittymästä löytyy kohta Tools ja sieltä Network. Tästä aukeaa näkymä jossa aluksi on vain yksi Host-Only yhteys. Klikkaamalla Create painiketta saadaan luotua uusi yhteys 
![image](https://github.com/AArmias/pentest/assets/102689055/12aa3c56-4601-4294-9515-144fb171fe0e)
Susanna osasi ohjeissaan neuvoa, että uuden virtuaaliverkon asetuksista DCHP Server on disabloituna, ohjeen mukaisesti käydään klikkaamassa `Enable Server` ruutuun raksi ja painetaan `Apply` eli hyväksytään kyseinen valinta. 
Nyt uusi virtuaaliverkko on luotu ja DHCP Serverikin on käytettävissä. 
![image](https://github.com/AArmias/pentest/assets/102689055/07e09254-192a-4d09-a643-843157288709)

Seuraavaksi kytketään molemmat koneet Penkali (Kali linux) ja Metasploitaple2 (Metaspoitable 2) tähän juuri luotuun virtuaaliverkkoon. 

Jälleen VirtualBoxin käyttöliittymään ja sieltä klikataan ensiksi Penkali:a ja Settings.
![image](https://github.com/AArmias/pentest/assets/102689055/0f86b951-9cb1-4b5d-8e2b-7378738edb07)
Seuraavaksi Network asetukset auki ja Attached to: kohdassa oleva `NAT` korvataan `Host-only Adapter` vaihtoehdolla. Valitaan name: kohtaan `VirtualBox Host-Only Ethernet Adapter #2` ja klikataan `OK`. 
![image](https://github.com/AArmias/pentest/assets/102689055/ac66f2b2-65e0-4bed-bcb0-b37ff5201f49)

Toistetaan sama Metasploitaple2 koneelle: 
![image](https://github.com/AArmias/pentest/assets/102689055/fc830c3c-ccf3-4753-951c-9502e5574e4d)

Nyt koneiden pitäisi olla samassa testiverkossa. 

----------------

### - Osoita eri komennoilla, että Internet-yhteys katkeaa: 'ping 1.1.1.1', 'ping www.google.com', 'curl www.google.com'. Vapaaehtoisena lisänä: Kali saa yhteyden Internettiin, mutta sen voi laittaa pois päältä.
Nyt kun Penkali on kytkettynä tuohon aiemmin luotuun virtuaaliverkkoon Host-onlynä, ei siitä pitäisi päästä ulos ja vaikkapa `www.google.comi` sivulle.

Kokeillaan kuitenkin pitääkö tämä paikkansa. Kokeilin ensimmäistä komentoa `ping 1.1.1.1`. 
![image](https://github.com/AArmias/pentest/assets/102689055/d9d56d3a-dc7b-4a5f-9250-71b2eb914819)
Seuraavaksi `ping www.google.com` 
![image](https://github.com/AArmias/pentest/assets/102689055/5baeb748-af27-46e0-b3ff-ef4c65e6d66d)
ja viimeiseksi `curl www.google.com`
![image](https://github.com/AArmias/pentest/assets/102689055/dc830e9c-1ea7-4c46-a14e-c298371c4427)
Tästä voidaan päätellä, ettei internet yhteyttä ole.

Kokeillaan Kuitenkin vielä asettaa hetkellisesti Penkalin takaisin oletus asetuksiin, eli `NAT` tila takaisin verkkoasetuksista ja katsotaan mitä tapahtuu: 
![image](https://github.com/AArmias/pentest/assets/102689055/60328884-ebae-4426-820e-387b70d324d8)
![image](https://github.com/AArmias/pentest/assets/102689055/af15cf80-2650-45c9-846e-1edda41486d6)
Huomattava eri ja selvästi internet yhteys on nyt käytössä. 

Asetetaan viimeisen kerran asetukset ympäri, eli Host-only takaisin päälle ja kokeillaan uudelleen:
![image](https://github.com/AArmias/pentest/assets/102689055/b911b434-b682-4bb8-a9f4-1aca8b3ff22b)
Voidaan todeta, että jälleen kerran ollaan ilman internet yhteyttä. 

--------------------------






### Lähteet:
- Tunkeutumistestaus 2024 - `https://terokarvinen.com/2024/eettinen-hakkerointi-2024/`
- Metasploitable 2 guide - `https://docs.rapid7.com/metasploit/metasploitable-2`
- install Kali Linux 2024.1 & Metasploitable2 on VirtualBox 7 Step By Step : Cyber Security Lab 2024 - `https://www.youtube.com/watch?v=yf3jetn4tN8`
- Kali - `https://www.kali.org`
- Susanna Lehdon blogi - `https://susannalehto.fi/2023/oma-labra-tunkeutumistestaukseen-h1/`
