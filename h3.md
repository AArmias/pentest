## h3 Fuff faster


### x) Lue/katso ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva kustakin artikkelista. Kannattaa lisätä myös jokin oma ajatus, idea, huomio tai kysymys.)
- Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf
- Karvinen 2022: Cracking Passwords with Hashcat
- Karvinen 2023: Crack File Password With John


--------------------------------


### a) Asenna Hashcat ja testaa sen toiminta murtamalla esimerkkisalasana.

Koska käytän tehtävien tekemisessä Kali pohjaista virtuaalikonetta on Hashcat, wget ja hashid valmiiksi asennettuna. Mikäli käytät esimerkiksi ubuntua tai debiania voi Haschatin kuitenkin asentaa helposti komennolla `sudo apt-get -y install hashcat`
Kuten aina, tärkein komento ennen asentamista on: `sudo apt-get update`. Lisäksi suosittelen asentamaan seuraavassa raportissa tarvittavat hashid ja wget, komennolla `sudo apt-get -y install hashid wget`. 

Nyt kun tehtävän ensimmäinen osa Hashcatin asennus on suoritettu, voidaan syventyä siihen miten se toimii ja kokeilla murtaa esimerkkisalasana. 
Apuna tehtävässä käytän Tero Karvisen ohjetta: [Cracking Passwords with Hashcat](https://terokarvinen.com/2022/cracking-passwords-with-hashcat/)

Ensimmäinen vaihe kaiken tarvittavan asennuksen jälkeen on on luoda uusi kansio salasanan purkamista varten. Tämä tapahtuu komennolla `mkdir (kansion nimi)` tässä tapauksessa luodaan kansio `pilkotut` eli `mkdir pilkotut`.
Avataan tuo kyseinen kansio `cd pilkotut`, jonka jälkeen ladataan rockyou.txt niminen salasana lista. Lista sisältää noin 14 miljoonaa sanaa. Listan latausta varten tarvitaan aiemmin asennettu wget. 
Asennus tapahtuu käskyllä: `wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz`.
Puretaan tar.gz muotoon pakattu rockyou.txt komennolla: `tar xf rockyou.txt.tar.gz`.
Koska rockyou.txt.tar.gz on nyt purettu kansioon /pilkotut/ voidaan paketti tiedosto poistaa komennolla: `rm rockyou.txt.tar.gz`.

Kurkataan mitä tuo `rockyou.txt` tiedosto pitää sisällään: 

![image](https://github.com/AArmias/pentest/assets/102689055/549bc182-b961-42ef-a150-0a76a9eee0c6)

Keskeytin lustauksen `Ctrl+C` komennolla, koska se olisi jatkunut todella pitkään. Nähdään kuitenkin selvästi, että lista tosiaan sisältää yksinkertaisia salasanoja. 
Koska halusin kokeilla Hashcatia enemmän ja eri tyyppisten salasanojen purkamiseen löysin oivan sivuston harjoitustiivisteiden tekemiseen. [All Hash Generator](https://www.browserling.com/tools/all-hashes). 
Nyt voin luoda muutaman eri tyyppisen salasanatiivisteen ja kokeilla niiden purkamista. 

Tässä esimerkkinä salasana: `SaLaSaNa!q"w12` jonka MD5 tiiviste olisi: `5e03cc5301f38c85062c9764981b1f4a`
![image](https://github.com/AArmias/pentest/assets/102689055/be38f970-166e-48f5-b6e6-1bfd05d7d3d8)

Lisäksi kokeilin ymmärtääkseni facebookin käytössä olevaa SHA-256 algoritmin tiivistettä salasanalle: `face1` joka on: `b6ee57d9939d038ac555fd6aebb0298db57abdc78443d4252960d9f73ba9261f`
ja Windowsin käyttämän NTLM algoritmin tiivistettä salasanasta: `Windows` joka on:`9BE760E8DBBE3BE65210225AC1570C9F`.

Alussa lataamamme hashid on työkalu jolla voidaan tunnistaa minkä tyyppisestä salasanan tiivisteestä mahdollisesti on kyse. Tässä esimerkissä tiedämme tyypit, koska olemme itse ne tiivisteet luoneet. 
Kokeillaan kuitenkin mitä hashid sanoo tuolle SHA-256 tiivisteelle. 

![image](https://github.com/AArmias/pentest/assets/102689055/54c5d8f7-ecd8-43f7-94b6-57698f951ad1)

Komentona käytämme: `hashid -m` jossa tuo `-m` = toiminto joka kertoo meille Haschatin käyttämien algoritmimodejen koodin. Voisimme hyvin käyttää myös `-j` joka kertoisi JohnTheRipperin käyttämät muodot. 
Lisäksi laitamme tiivisteen `11ae1aabe9477e9968872f1741fa0e815dc2bd7084e6ecc4503459cf069e80c8` eli kokonaisuudessa  `hashid -m 11ae1aabe9477e9968872f1741fa0e815dc2bd7084e6ecc4503459cf069e80c8`
![image](https://github.com/AArmias/pentest/assets/102689055/a593b8dc-8173-4580-ae8f-bcf44dce411b)
Kuten kuva osoittaa, SHA-256 myös löytyy listalta jollaiseksi hashid tiivisteen luokittelee. 

Kokeillaan vielä toisella esimerkillä: `hashid -m 9BE760E8DBBE3BE65210225AC1570C9F`. 

![image](https://github.com/AArmias/pentest/assets/102689055/3094656a-6695-4fe9-946d-97b5715c864d)

Tällä kerralla vaihtoehtoja tuli huomattavasti enemmän. Huomiona kuvasta voidaan myös todeta, että hashid kertoo nuo pyytämämme (`-m`) hascatin käyttämät modet eri algoritmeille. 
Esimerkiksi MD5 algoritmin mode on 0, kun taas NTLM algoritmin mode on 1000. Tästä on hyötyä seuraavaan vaiheeseen. 


Tiivisteen purkaminen tapahtuu komennolla: `hashcat -m 0` tuo `-m 0` kertoo hashcatille moden. Edellisessä tehtävässä nähtiin jo että MD5 algoritmin mode on 0, joten käytämme ekassa kokeilussa sitä. 
Seuraavaksi tiiviste: `'5e03cc5301f38c85062c9764981b1f4a'` ja `rockyou.txt` sanalista. `-o selvitetty` käskee meidän luoda tiedosto selvitetty, jonne kirjoittaa talteen vastaus. 
eli kokonaisuudessan: `hashcat -m 0 '5e03cc5301f38c85062c9764981b1f4a' rockyou.txt -o selvitetty`

![image](https://github.com/AArmias/pentest/assets/102689055/77a83da0-3cf5-412d-b372-fa86b4c85310)

Käytössä virtuaalikoneella on ainoastaan 1 ydin kaikista 24:stä, tämä vaikuttaa varmasti käsittelynopeuteen ja vakauteen. Mikäli käytössä olisi kaikki koneen 24 ydintä, sekä näytönohjain RTX 4080 olisi käsittelynopeus ja vakaus aivan toista luokkaa. 
Yllä oleva kuva osoittaa, että käsittelynopeus on tällä kokoonpanolla vain 3 miljoonaa yritystä sekunnissa. 
Salasanan ratkaiseminen kesti tässä tapauksessa 7 sekuntia, josta itse toimempide 5 sekuntia ja loppui `Exhausted` statukseen. Salasanaa ei onnistuttu tällä kertaa ratkaisemaan. Tämän takia ei myöskään luotu `selvitetty` tiedostoa. 
Tässä on kuitenkin hyvä esimerkki siitä, että mikäli salasana on hiemankin normaalia sanaa vaikeampi, alkaa se vaatimaan enemmän laskentakapasiteettia. 
Salasanoihin panostaminen kannattaa ja mitä monimutkaisempi salasana on sitä enemmän murtaja joutuu sen ratkaisemiseen käyttämään resursseja ja aikaa. 


`hashcat -m 1400 'b6ee57d9939d038ac555fd6aebb0298db57abdc78443d4252960d9f73ba9261f' rockyou.txt -o selvitetty`
![image](https://github.com/AArmias/pentest/assets/102689055/867720c1-887b-44c9-959e-7f0c4eecd9e7)
![image](https://github.com/AArmias/pentest/assets/102689055/4a61a2ee-c4fc-4613-8bdc-bb5c02384f2a)

`hashcat -m 1000 '9BE760E8DBBE3BE65210225AC1570C9F' rockyou.txt -o selvitetty`
Tähän esimerkkinä tuloste, joka tulee jos salasanan on jo kerran murtanut. 

![image](https://github.com/AArmias/pentest/assets/102689055/c141b3ae-ef80-4475-b74c-b1ebfe800d03)

ja lopuksi, onnistuiko minkään salasanan murtaminen? 
![image](https://github.com/AArmias/pentest/assets/102689055/3daed03b-1a3a-454d-b7a0-8c5608015851)

Kyllä onnistui, helpot salasanat `Windows` ja `face1` murrettiin. MD5 salasana `SaLaSaNa!q"w12` oli liian haastava ja jäi murtamatta.


--------------------------------




### b) Salainen, mutta ei multa. Ratkaise dirfuzt-1 artikkelista Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf 

--------------------------------


Lähteet:

- Cracking Passwords with Hashcat - https://terokarvinen.com/2022/cracking-passwords-with-hashcat/
