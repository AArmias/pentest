## h5 Täysin Laillinen Sertifikaatti


### x) Lue/katso ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva kustakin artikkelista. Kannattaa lisätä myös jokin oma ajatus, idea, huomio tai kysymys.)
  
  #### OWASP 2021: OWASP Top 10:2021
    - A01:2021 – Broken Access Control (IDOR ja path traversal ovat osa tätä)
    - A10:2021 – Server-Side Request Forgery (SSRF)

  #### PortSwigget Academy:
    - Insecure direct object references (IDOR)
    - Path traversal
    - Server-side template injection
    - Server-side request forgery (SSRF)
    - Cross-site scripting

  #### Karvinen 2020: Using New Webgoat 2023.4 to Try Web Hacking


------------------------------------------------------------

### a) Totally Legit Sertificate. Asenna OWASP ZAP, generoi CA-sertifikaatti ja asenna se selaimeesi. Laita ZAP proxyksi selaimeesi. Laita ZAP sieppaamaan myös kuvat, niitä tarvitaan tämän kerran kotitehtävissä. Osoita, että hakupyynnöt ilmestyvät ZAP:n käyttöliittymään. (Ei toimi localhost:lla ilman Foxyproxya)


### b) Kettumaista. Asenna FoxyProxy Standard Firefox Addon, ja lisää ZAP proxyksi siihen. Käytä FoxyProxyn "Patterns" -toimintoa, niin että vain valitsemasi weppisivut ohjataan Proxyyn. (Läksyssä ohjataan varmaankin PortSwigger Labs ja localhost.)
PortSwigger Labs. Ratkaise tehtävät. Selitä ratkaisusi: mitä palvelimella tapahtuu, mitä eri osat tekevät, miten hyökkäys löytyi, mistä vika johtuu. Kannattaa käyttää ZAPia, vaikka malliratkaisut käyttävät harjoitusten tekijän maksullista ohjelmaa. Malliratkaisun kopioiminen ZAP:n tai selaimeen ei ole vastaus tehtävään, vaan ratkaisu ja haavoittuvuuden etsiminen on selitettävä ja perusteltava.

### Insecure Direct Object Reference (IDOR)
#### c) Insecure direct object references

### Path traversal
#### d) File path traversal, simple case

#### e) File path traversal, traversal sequences blocked with absolute path bypass

#### f) File path traversal, traversal sequences stripped non-recursively

### Server Side Template Injection (SSTI)
#### g) Server-side template injection with information disclosure via user-supplied objects (Tämä on merkitty hieman vaikeammaksi, jätä viimeiseksi jos näyttää hankalalta)
Server Side Request Forgery (SSRF)

#### h) Basic SSRF against the local server

### Cross Site Scripting (XSS)
#### i) Reflected XSS into HTML context with nothing encoded

#### j) Stored XSS into HTML context with nothing encoded

---------------------------

### k) Asenna Webgoat 2023.4. (Uusi versio, jossa on eri tehtäviä kuin vanhemmissa. Jos olet jo asentanut sen, ei tarvitse raportoida asennusta uudelleen; raportoi silloin vain pelkkä testi, jolla toteat sen toimivaksi.)

Olimme ensimmäisessä kotitehtävässä asentanteet vanhemman Webgoat version, joten uuden version asentaminen oli edessä. 
Ohjeet asennukseen löytyi Tero karvisen julkaisusta: [Try Web Hacking on New Webgoat 2023.4](https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/).

Normaali lähtötapa eli paketit päivitykseen: 
    
    $ sudo apt-get update
Lisäksi asennetaan java laajennus, mikäli sitä ei ole:     
    
    $ sudo apt-get install openjdk-17-jre
Itsellä tällä kertaa java laajennus oli valmiina. 

![image](https://github.com/AArmias/pentest/assets/102689055/fa2a4549-b1f2-421e-ad5d-af18b21bf02e)

Palomuurin asennus ja käynnistys, mikäli sitä ei ole tehnyt: 

    $ sudo apt-get install ufw
    $ sudo ufw enable

Itselläni palomuuri jo kävi ja kukkui valmiiksi. 

![image](https://github.com/AArmias/pentest/assets/102689055/7d20dec8-72f8-4da0-ba6f-abaddb1fb134)

Mikäli wget ei ole asennettuna on se hyvä tehdä tässä vaiheessa: 

    $ sudo apt-get install wget

sekin löytyi tällä kertaa jo valmiiksi. 

![image](https://github.com/AArmias/pentest/assets/102689055/926dcb3c-2bd2-40cb-83bc-5acae366ba1e)

Sitten Webgoat 2023.4. paketin lataus: 

    $ wget https://github.com/WebGoat/WebGoat/releases/download/v2023.4/webgoat-2023.4.jar

![image](https://github.com/AArmias/pentest/assets/102689055/1b5ad8b8-3edf-40f6-9e9d-b28f966a8a9f)

Koska Webgoat harjoituksia tehdessä koneella tullaan saman aikaisesti ajamaan ZAP välimiesproxyä, joka käyttää porttia 8080 samoin kuin Webgoat tekisi, vaihdetaan WebGoatin portti 8888 ja Webwolfin 9090. 
Samalla käynnistetään Webgoat käyttöä varten. 

    $ java -Dfile.encoding=UTF-8 -Dwebgoat.port=8888 -Dwebwolf.port=9090 -jar webgoat-2023.4.jar

![image](https://github.com/AArmias/pentest/assets/102689055/e0720e62-4cc9-43fb-b879-5526512bd2d6)

Mikäli asennus on onnistunut nyt meillä pitäisi olla WebGoat päällä. Tarkistetaan se menemällä osoitteeseen: `http://127.0.0.1:8888/WebGoat`

![image](https://github.com/AArmias/pentest/assets/102689055/40e12dbf-83f9-4be2-a920-e24cede44446)

Käynnissä on. 

Nyt vuorossa on käyttäjän luonti ja harjoituksen aloitus. 

![image](https://github.com/AArmias/pentest/assets/102689055/c2ebf509-8890-4bf5-8f44-8068f1225d30)

![image](https://github.com/AArmias/pentest/assets/102689055/f2bf0e24-50ea-4339-9802-7b16d9cb569d)


----------------------------------------------------------------------------------------------------








### l) Asenna pencode ja muunna sillä jokin merkkijono (encode a string).

------------------------------------------------------------------

### Ratkaise WebGoat 2023.4:
#### m) (A1) Broken Access Control (WebGoat 2023.4. Pitää olla nimenomaan tämä versio. Eri versioissa on eri tehtävät.)
    - Hijack a session (1) [vaikea]
    - Insecure Direct Object References (4) [vaikeita kohtia]
    - Missing Function Level Access Control (2) [Ei kohtaa 4 "The company fixed the problem, right?", se saattaa olla rikki]

#### n) (A7) Identity & Auth Failure (WebGoat 2023.4)
    - Authentication Bypasses (1)
    - Insecure Login (1)

#### o) (A10) Server-side Request Forgery (WebGoat 2023.4)
    - Server-Side Request Forgery (2)

#### p) Client side (WebGoat 2023.4)
    - Bypass front-end restrictions (2)

----------------------------------------------------------------------
### Lähteet:
- Try Web Hacking on New Webgoat 2023.4 - https://terokarvinen.com/2023/webgoat-2023-4-ethical-web-hacking/
- Tunkeutumistestaus 2024 - https://terokarvinen.com/2024/eettinen-hakkerointi-2024/
- 
