# h1 Hacker Warmup 

### Tehtävät saa aloittaa vasta, kun on hyväksynyt kurssin säännöt. Mitään ulkopuolisia koneita ei saa porttiskannata ilman lupaa. Irrota tarvittaessa virtuaalikone Internetistä kokeilujen ajaksi. Tässä kotitehtävässä porttiskannaukset tehdään ensisijaisesti localhost-osoitteella. 

Tehtävän määräaika on 24 h ennen seuraavaa oppituntia, eli pääsiäisen takia vasta 2024-04-07 w14 su 08:15. Kannattaa aloittaa tehtävien teko saman tien, jotta saa hakkeroida rauhassa.

Tässä harjoituksessa on tiedustelua ja lämmittelyä. Pääset lukemaan sen kuuluisan paperin kybertappoketjusta. Tutustut O'Reilly Learning -alustan videokursseihin. Kokeilet montaa harjoitusympäristöä. Jos hakkerointi sujuu jo, näillä samoilla alustoilla voit harjoitella myös kurssin ulkopuolella.

--------------------------------------------------------------

### x) Lue/katso ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva.) 
#### - € Santos et al: The Art of Hacking (Video Collection): [..] [4.3 Surveying Essential Tools for Active Reconnaissance](https://www.oreilly.com/videos/the-art-of/9780135767849/9780135767849-SPTT_04_00/). Sisältää porttiskannauksen. 5 videota, yhteensä noin 20 min. 
- Active Reconnaissance = Aktiivinen tiedustelu, jota esimerksiksi porttiskannaus on. Voidaan myös kutsua  joskus nimellä "Scanning phase - skannaus vaihe"
- Aktiivisessa tiedustelussa kohde verkkoon lähetetään paketteja, toisin kuin passiivisessa tiedustelussa. 
- Mikäli kohdeverkossa ollaan hereillä on aktiivinen tiedustelu (portti skannaus) helppo huomata monitoroimalla ja katsomalla logitiedostoja. Aktiivinen tiedustelu jättää jäljet ja herättää huomiota, toisin kuin passiivinen tiedustelu.
- Mitä enemmän skannausta suoritetaan, sitä enemmän se myös pitää "ääntä" ja herättää huomiota.
- Kolme vaihetta: 1. Portti skannaus, 2. Verkkopalvelun läpikäynti ja 3. Haavoittuvuuksien skannaus. 
- Porttiskannauksen apuvälineitä: [Nmap](https://nmap.org/) Yleisin ja monipuolisin vaihtoehto, ollut olemassa jo pitkään. (yli 20 vuotta.) ja [Masscan](https://github.com/robertdavidgraham/masscan) Nopein skanneri. 
- Verkkopalvelun läpikäyntiin työkaluksi tarjotaan: [EyeWitness](https://github.com/ChrisTruncer/EyeWitness-Ruby) Helpottaa erityisesti isojen palveluiden läpikäymistä ja kohteen priorisointia.
- Haavoittuvuuksien skannausta voidaan sanoa olevan kahdenlaista. Network vulnerability eli Tietoverkosta tapahtuvaa ja Web vulnerability eli internetissä tapahtuvaa skannausta. Molemmille löytyy omat työkalut. 
- Network vulnerability työkalut: OpenVAS, Nessus, Nexpose, Qualys, Nmap
- Web vulnerability työkalut: Nikto, WPScan, SQLMap, Burp Suite, Zed Attack Proxy

#### - [Hutchins et al 2011: Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains](https://lockheedmartin.com/content/dam/lockheed-martin/rms/documents/cyber/LM-White-Paper-Intel-Driven-Defense.pdf), chapters Abstract, 3.2 Intrusion Kill Chain.

-----------------------------------------------------------

a) Ratkaise Over The Wire: Bandit kolme ensimmäistä tasoa (0-2).

-----------------------------------------------------------

### b) Asenna WebGoat ja kokeile, että pääset kirjautumaan sisään.

Aloitin WebGoatin asentamisen avaamalla yksinkertaiset ohjeet osoitteesta: https://terokarvinen.com/2020/install-webgoat-web-pentest-practice-target/

Ensimmäinen askel oli päivittää debian tähän päivään. Komennolla `sudo apt-get update` tämä hoituu, jonka jälkeen ohje neuvoi asentamaan seuraavat lisäykset: openjdk 17 (java), ufw (palomuuri), wget (ohjeen myöhemmässä vaiheessa tulevan paketin lataamiseen), bash-completion (lisää komentoja terminaaliin). Lataus tapahtuu käskyllä: `sudo apt-get -y install openjdk-17-jre ufw wget bash-completion` Tällä päästään eteenpäin! 

Seuraava vaihe on käynnistää juudi asennettu UFW palomuuri, tämä tapahtuu komennolla: `sudo ufw enable`. 

Jälellä olisi enää itse webgoatin lataaminen joka onnistuu joko lataamalla se käskyllä: `wget https://terokarvinen.com/2020/install-webgoat-web-pentest-practice-target/webgoat-server-8.0.0.M26.jar` tai lataamalla kyseinen .jar tiedosto suoraa selaimella. 
Itse WebGoatin asentaminen ja käynnistys tapahtuu käskyllä: `java -jar webgoat-server-8.0.0.M26.jar`.

Nyt Webgoat on toiminnassa, ohjetta noudattaen seuraava vaihe on luoda tunnus ja kirjautua WebGoattiin. Tämä tapahtuu avaamalla osoite `"http://localhost:8080/WebGoat/"` nettiselaimeen. Sivulla on mahdollisuus kirjautua suoraa sisälle tai luoda tunnu. Tunnusta luodessa sivu kysyy käyttäjätunnusta ja 6-10 merkkistä salasanaa. Tunnuksen luonti on varsin nopeaa, kun tunnus on luotu kirjaudutaan sisälle juuri luomilla tunnuksilla, nyt kaikki on valmista itse harjoituksien aloittamiseen! 

-----------------------------------------------------------------

### c) Ratkaise WebGoatista tehtävät "HTTP Basics" ja "Developer tools". Katso vinkit alta.
#### - HTTP Basics:
  Osassa 1 kerrotaan miten nettisivut toimivat ja mikä on perusidea. Joko käsky on GET tai POST, jonka ympärille kaikki rakentuvat. 
  
  Osassa 2 näytetään miten tavallinen nettisivuilta löytyvä kaavake toimii ja annetaan mahdollisuus kokeilla sitä. 
  
  Osassa 3 tulee itse tehtävä. Tehtävässä pyydetään täyttämään ensimmäiseen hakukentän ruutuun "`What type of HTTP command did WebGoat use for this lesson. A POST or a GET."` eli suomennettuna `"Minkä tyyppistä HTTP-komentoa WebGoat käytti tällä oppitunnilla. POST tai GET.`" vastaus ensimmäiseen ruutuun on POST. Mikäli ruutuun syöttää GET saa ilmoituksen väärästä vastauksesta. Kun vastaa oikein, aktivoituu seuraavan kentän vastaus `"You are close, try again: the magic number is incorrect."` Joten oikea taikanumero pitäisi vielä keksiä. Koska kentään mahtuu loputtomasti numeroita on taikanumeron keksimen yksitellen kokeilemalla melko iso prosessi. Jonkin muu ratkaisu on siis keksittävä. 
  
Ensimmäisellä tunkeutumistestauksen tunnilla meille kerrottiin jo siitä, miten Firefoxin F12 näppäin vastaa jo melko hyviä työkaluja perus tunkeutumiseen. Vielä paremman hyödyn tässä tapauksessa saa hiiren oikeaa nappia apuna käyttäen. Klikkaamalla kaavakkeeseen ja painamalla tarkista, ollaan jo melko lähellä ratkaisua. Syötetään hakukenttään mitä massasta yritetään löytää: `"Magic"` ja devtoolsin haku kenttä tarjoaa meille kuin tarjottimella: `"#magic_num"` vaihtoehtoa. Valitaan se html koodin seasta löytyy rivi: `"<input id="magic_num" type="hidden" name=magic_num" value="56">"`
Kenttä kertoo meille taikanumeron arvoksi 56, kokeillaan syöttää tämä luku kaavakkeen kenttään ja huomataan sen toimivan! Tehtävä suoritettu! 


--------------------------------------------------------------------

### d) Ratkaise ja selitä PortSwigger Labs: Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data. (Edellyttää ilmaista rekisteröitymistä. Tehtävän voi ratkaista pelkästään selaimen osoitekenttää muokkaamalla.) Selitä, mitä tekniikoita kokeilit, ja mitä hyökkäyksesi eri osat tekevät.


### e) Asenna Linux virtuaalikoneeseen. Suosittelen joko Kali (viimeisin versio) tai Debian 12-Bookworm.

--------------------------------------------

#### f) Porttiskannaa 1000 tavallisinta tcp-porttia omasta koneestasi (localhost). Analysoi tulokset. 
Tätä tehtävää varten asensin ensimmäisessä tehtävässä tutuksi tulleen nmap nimisen työkalun, juuri edellisessä tehtävässä asentamalleni virtuaalikoneelle Debian 12 virtuaalikoneelle. Nopeasti nmapin manuaalista selviää, että perus skannauksella työkalu suorittaa skannauksen 1000 tavallisimpaan tcp-porttiin. 
![image](https://github.com/AArmias/pentest/assets/102689055/76f8f4a7-007e-454b-a21f-a3974896c394)

Ennen testin suorittamista katkaisin virtuaalikoneestani yhteydet ulospäin verkkoasetuksista, jotta mitään vahinkoa ei pääse tapahtumaan. Itse skannauksen tein käskyllä `sudo nmap localhost` ja vastaukseksi sain: 
![image](https://github.com/AArmias/pentest/assets/102689055/62327424-518d-4bf2-aca6-2a80e80a854f)
Kaikki 999 porttia olivat kiinni, koska olin asentanut virtuaalikoneelle ufw palomuurin ja aktivoinut sen. Kokeilin kytkeä ufw:n pois päältä ja suorittaa skannauksen uudelleen. 
![image](https://github.com/AArmias/pentest/assets/102689055/452ff1e2-a323-43d1-b170-13f9974fea7e)
![image](https://github.com/AArmias/pentest/assets/102689055/13131937-7eb2-41d8-8486-ab14180dd49d)




